<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ArtMoots - Account</title>
<style>
:root{--bg:#f9f9f9;--text:#333;--accent:#111;--border:#ddd;}
body{font-family:"Segoe UI",Arial,sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:2rem;}
form{background:white;padding:2rem;border-radius:8px;width:320px;display:flex;flex-direction:column;gap:1rem;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
input{padding:0.6rem;border-radius:6px;border:1px solid var(--border);}
input:focus{border-color:var(--accent);}
button{background:var(--accent);color:white;border:none;padding:0.6rem;border-radius:6px;cursor:pointer;font-weight:500;}
button:hover{background:#222;}
.toggle{color:var(--accent);cursor:pointer;font-size:0.9rem;text-align:center;}
#accountInfo{display:none;background:white;padding:1.5rem;border-radius:8px;width:320px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
</style>
</head>
<body>

<h1>Welcome to ArtMoots</h1>

<form id="signupForm">
  <h2>Sign Up</h2>
  <input type="text" id="signupUsername" placeholder="Username" required>
  <input type="email" id="signupEmail" placeholder="Email" required>
  <input type="password" id="signupPassword" placeholder="Password" required>
  <button type="submit">Create Account</button>
  <div class="toggle" onclick="toggleForms()">Already have an account? Log in</div>
</form>

<form id="loginForm" style="display:none">
  <h2>Login</h2>
  <input type="text" id="loginUsername" placeholder="Username" required>
  <input type="password" id="loginPassword" placeholder="Password" required>
  <button type="submit">Log In</button>
  <div class="toggle" onclick="toggleForms()">Don't have an account? Sign up</div>
</form>

<div id="accountInfo">
  <h2>My Account</h2>
  <p id="accUsername"></p>
  <p id="accEmail"></p>
  <button id="logoutBtn">Logout</button>
</div>

<script src="accounts-database.js"></script>
<script>
const signupForm = document.getElementById("signupForm");
const loginForm = document.getElementById("loginForm");
const accountInfo = document.getElementById("accountInfo");
const accUsername = document.getElementById("accUsername");
const accEmail = document.getElementById("accEmail");
const logoutBtn = document.getElementById("logoutBtn");

function toggleForms() {
  signupForm.style.display = signupForm.style.display==="none"?"flex":"none";
  loginForm.style.display = loginForm.style.display==="none"?"flex":"none";
}

// URL mode & return page
const params = new URLSearchParams(window.location.search);
const mode = params.get("mode");
const returnPage = params.get("return") || "index.html";

const currentUser = getCurrentUser();
if(currentUser && mode==="account"){
  signupForm.style.display="none";
  loginForm.style.display="none";
  accountInfo.style.display="block";
  accUsername.textContent = "Username: " + currentUser;
  const acc = getAccounts().find(a=>a.username===currentUser);
  accEmail.textContent = "Email: " + acc.email;
}

if(mode==="login"){signupForm.style.display="none"; loginForm.style.display="flex";}
if(mode==="signup"){signupForm.style.display="flex"; loginForm.style.display="none";}

// Sign Up
signupForm.addEventListener("submit", e=>{
  e.preventDefault();
  const username = document.getElementById("signupUsername").value.trim();
  const email = document.getElementById("signupEmail").value.trim();
  const password = document.getElementById("signupPassword").value;
  if(signUp(username,email,password)) window.location.href = returnPage;
});

// Login
loginForm.addEventListener("submit", e=>{
  e.preventDefault();
  const username = document.getElementById("loginUsername").value.trim();
  const password = document.getElementById("loginPassword").value;
  if(login(username,password)) window.location.href = returnPage;
});

// Logout
logoutBtn.addEventListener("click",()=>{
  logout();
  window.location.href = "index.html";
});
</script>
</body>
</html>
